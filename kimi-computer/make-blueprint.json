[
  {
    "id": "webhook",
    "type": "webhook",
    "name": "Groq-Powered Pipeline",
    "config": {
      "body": {
        "source_url": "{{body.source_url}}",
        "source_type": "{{body.source_type}}",
        "bat_tip": "{{body.bat_tip}}"
      }
    }
  },
  {
    "id": "fetch",
    "type": "http",
    "name": "Download Content",
    "config": {
      "url": "{{webhook.source_url}}",
      "method": "GET",
      "timeout": 30
    }
  },
  {
    "id": "insight_agent",
    "type": "ai-agent",
    "agent_id": "InsightSynthesizer",
    "input": {
      "content": "{{fetch.body}}",
      "source_type": "{{webhook.source_type}}"
    }
  },
  {
    "id": "tweet_agent",
    "type": "ai-agent",
    "agent_id": "TweetOptimizer",
    "input": {
      "key_quote": "{{insight_agent.key_quote}}",
      "context": "BAT-monetized thread",
      "max_chars": 280
    }
  },
  {
    "id": "bat_agent",
    "type": "ai-agent",
    "agent_id": "BAT Analyst",
    "input": {
      "conversion_data": "{{webhook}}",
      "insight_card": "{{insight_agent}}"
    }
  },
  {
    "id": "notion",
    "type": "notion",
    "operation": "create_page",
    "database_id": "{{env.NOTION_DB_ID}}",
    "properties": {
      "Title": { "title": [{ "text": { "content": "{{insight_agent.title}}" }}] },
      "TL;DR": { "rich_text": [{ "text": { "content": "{{insight_agent.tl;dr}}" }}] },
      "Key Quote": { "rich_text": [{ "text": { "content": "{{insight_agent.key_quote}}" }}] },
      "Tags": { "multi_select": "{{insight_agent.tags}}" },
      "BAT Revenue": { "number": "{{bat_agent.predicted_revenue}}" },
      "Auto-tweet?": { "checkbox": true }
    }
  },
  {
    "id": "ayrshare",
    "type": "http",
    "name": "Post Optimized Tweet",
    "config": {
      "url": "https://api.ayrshare.com/api/post",
      "method": "POST",
      "headers": {
        "Authorization": "Bearer {{env.AYR_KEY}}"
      },
      "body": {
        "post": "{{tweet_agent.optimized_tweet}}",
        "platforms": ["twitter", "linkedin"]
      }
    }
  }
]
